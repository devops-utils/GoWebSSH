var D=Object.defineProperty,v=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable;var b=(e,o,a)=>o in e?D(e,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[o]=a,g=(e,o)=>{for(var a in o||(o={}))I.call(o,a)&&b(e,a,o[a]);if(E)for(var a of E(o))x.call(o,a)&&b(e,a,o[a]);return e},B=(e,o)=>v(e,k(o));import{a as M,d as $,N as S,M as U,O as N,Y as T,P,Q as j,R as X,V as O,U as R,o as F,v as C,n as t,w as l,a2 as z,X as r,A as m,a3 as J,a4 as Q,t as Y}from"./vendor.649983a5.js";import{_ as q,X as f}from"./index.f156c8d2.js";let n=M({active_name:"connectInfo",host_list:Array(),is_login:!1,password:"",old_password:"",new_password_a:"",new_password_b:""});function G(e,o){new f().delete(`/api/status?session_id=${o.session_id}`).then(p=>p.json()).then(p=>{p.code===0&&A()})}function A(){if(n.is_login){var e=new EventSource("/api/status");e.onmessage=function(o){let a=JSON.parse(o.data);a.code===0&&(n.is_login=!0,n.host_list=a.data)}}}function H(){let e=new FormData;e.append("pwd",n.password),new f().post("/api/login",{body:e}).then(a=>{if(a.status===401){r.error("\u5BC6\u7801\u9519\u8BEF");return}return a.json()}).then(a=>{a.code===0&&(n.is_login=!0,A())})}function K(){if(n.old_password.length===0){r.error("\u65E7\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A");return}if(n.new_password_a.length===0){r.error("\u65B0\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A");return}if(n.new_password_b.length===0){r.error("\u786E\u8BA4\u65B0\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A");return}if(n.new_password_a!==n.new_password_b){r.error("\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4");return}let e=new FormData;e.append("old_pwd",n.old_password),e.append("new_pwd",n.new_password_a),new f().patch("/api/login",{body:e}).then(a=>a.json()).then(a=>{a.code===0&&(r.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F"),n.is_login=!1)})}const L=$({name:"manage",setup(e,o){return B(g({},z(n)),{login:H,disconnect:G,changePassword:K})}}),W=e=>(J("data-v-1fa48446"),e=e(),Q(),e),Z={key:0},ee=m("\u65AD\u5F00"),oe=m("\u63D0\u4EA4"),te={key:1},ae=W(()=>Y("h3",{class:"login-title"},"\u8BF7\u767B\u5F55",-1)),le=m("\u767B\u5F55");function ne(e,o,a,p,ue,se){const s=S,_=U,V=N,w=T,i=P,d=j,c=X,h=O,y=R;return e.is_login?(F(),C("div",Z,[t(y,{modelValue:e.active_name,"onUpdate:modelValue":o[3]||(o[3]=u=>e.active_name=u),type:"card"},{default:l(()=>[t(w,{label:"\u8FDE\u63A5\u72B6\u6001",name:"connectInfo"},{default:l(()=>[t(V,{data:e.host_list,style:{width:"100%"}},{default:l(()=>[t(s,{fixed:"",prop:"ip",label:"\u5730\u5740",width:"250"}),t(s,{prop:"username",label:"\u7528\u6237\u540D",width:"180"}),t(s,{prop:"port",label:"\u7AEF\u53E3"}),t(s,{prop:"shell",label:"shell"}),t(s,{prop:"session_id",label:"\u4F1A\u8BDDID",width:"200"}),t(s,{prop:"start_time",label:"\u8FDE\u63A5\u521B\u5EFA\u65F6\u95F4",width:"150"}),t(s,{fixed:"right",label:"\u64CD\u4F5C"},{default:l(u=>[t(_,{size:"small",type:"danger",onClick:de=>e.disconnect(u.$index,u.row)},{default:l(()=>[ee]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(w,{label:"\u7BA1\u7406\u5BC6\u7801",name:"second"},{default:l(()=>[t(h,null,{default:l(()=>[t(c,{"label-width":"100px"},{default:l(()=>[t(d,{label:"\u65E7\u5BC6\u7801"},{default:l(()=>[t(i,{type:"password",minlength:"1",maxlength:"64",modelValue:e.old_password,"onUpdate:modelValue":o[0]||(o[0]=u=>e.old_password=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(d,{label:"\u65B0\u5BC6\u7801"},{default:l(()=>[t(i,{type:"password",minlength:"1",maxlength:"64",modelValue:e.new_password_a,"onUpdate:modelValue":o[1]||(o[1]=u=>e.new_password_a=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(d,{label:"\u65B0\u5BC6\u7801"},{default:l(()=>[t(i,{type:"password",minlength:"1",maxlength:"64",modelValue:e.new_password_b,"onUpdate:modelValue":o[2]||(o[2]=u=>e.new_password_b=u),modelModifiers:{trim:!0}},null,8,["modelValue"])]),_:1}),t(d,null,{default:l(()=>[t(_,{type:"primary",onClick:e.changePassword},{default:l(()=>[oe]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])):(F(),C("div",te,[t(h,null,{default:l(()=>[t(c,{"label-width":"80px",class:"login-box"},{default:l(()=>[ae,t(d,{label:"\u5BC6\u7801"},{default:l(()=>[t(i,{type:"password",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",modelValue:e.password,"onUpdate:modelValue":o[4]||(o[4]=u=>e.password=u)},null,8,["modelValue"])]),_:1}),t(d,null,{default:l(()=>[t(_,{type:"primary",onClick:e.login},{default:l(()=>[le]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]))}var _e=q(L,[["render",ne],["__scopeId","data-v-1fa48446"]]);export{_e as default};
